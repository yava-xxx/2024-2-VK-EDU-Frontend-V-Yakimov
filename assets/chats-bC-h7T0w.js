(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();const h=[{lastName:"Иванов",firstName:"Иван",patronymic:"Иванович",nickname:"ivan_ivanov",password:"password123",about:"Hello, I am Ivan!"},{lastName:"Петров",firstName:"Петр",patronymic:"Петрович",nickname:"petr_petrov",password:"password456",about:"Hello, I am Petr!"},{lastName:"Баранников",firstName:"Роман",patronymic:"Романович",nickname:"rbarannikov",password:"roman",about:"Hello, I am Roma!"}],u=(e,t)=>{localStorage.setItem(t,JSON.stringify(e))},l=e=>{const t=localStorage.getItem(e);return t?JSON.parse(t):null},m=e=>{u(e.chats,"chatData")},c=()=>l("chatData"),f=e=>{u(e.users,"userData")},d=()=>l("userData"),g=()=>{const e=new p;return d()?e.users=d()||[]:(h.forEach(t=>{e.addUser(t)}),f(e)),e};class p{constructor(){this.users={}}addUser({lastName:t,firstName:s,patronymic:a,nickname:r,password:o,about:i}){const n=(Object.keys(this.users).length+1).toString();this.users[n]={id:n,lastName:t,firstName:s,patronymic:a,nickname:r,password:o,about:i}}getUser(t){return this.users[t]}getAllUsers(){return Object.values(this.users)}getUserByNickname(t){for(const s in this.users)if(this.users[s].nickname===t)return this.users[s];return null}}const v=g(),D=[{id:1,messages:[{id:1,text:"Привет!",sentOrReceived:"sent",status:"read",date:"2022-07-25",timestamp:"12:00:00",senderName:"Вы",userId:1,chatId:1},{id:2,text:"Привет!",sentOrReceived:"received",status:"read",date:"2022-07-25",timestamp:"12:01:00",senderName:"Иван Иванов",userId:2,chatId:1}],users:[1,2]},{id:2,messages:[{id:1,text:"Привет!",status:"read",date:"2022-07-25",timestamp:"12:00:00",userId:3,chatId:2},{id:2,text:"Здравствуй!",status:"sent",date:"2022-07-25",timestamp:"12:01:00",userId:1,chatId:2}],users:[1,3]}],y=()=>{const e=new I;return c()?e.chats=c()||[]:(D.forEach(t=>{let s=e.getChat(t.id)||e.addChat();t.users.forEach(a=>{e.addUser(s.id,a)}),t.messages.forEach(a=>{e.addMessage(s.id,a)})}),m(e)),e};class I{constructor(){this.chats=[]}addChat(){const s={id:(this.chats.length+1).toString(),title:"",messages:[],users:[]};return this.chats.push(s),s}getChat(t){return this.chats.find(s=>s.id===t)||null}addMessage(t,s){const a=this.getChat(t);a&&a.messages.push(s)}setTitle(t,s){const a=this.getChat(t);a&&(a.title=s)}addUser(t,s){const a=this.getChat(t);a&&a.users.push(s)}getChatsForUser(t){return this.chats.filter(s=>s.users.includes(Number(t)))}}const N=y();export{m as a,l as b,N as c,d as l,u as s,v as u};
